{% extends "rental/base.html" %}
{% load rental_extras %}
{% load static %}

{% block title %}My Booking Dashboard{% endblock %}

{% block content %}
    <!-- Interactive Feature Tabs -->
    <div class="dashboard-tabs animate-on-scroll fade-in">
        <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="bookings-tab" data-bs-toggle="tab" data-bs-target="#bookings" 
                    type="button" role="tab" aria-controls="bookings" aria-selected="true">
                    <i class="fas fa-calendar-check"></i> My Bookings
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="billing-tab" data-bs-toggle="tab" data-bs-target="#billing" 
                    type="button" role="tab" aria-controls="billing" aria-selected="false">
                    <i class="fas fa-file-invoice-dollar"></i> Billing
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="preferences-tab" data-bs-toggle="tab" data-bs-target="#preferences" 
                    type="button" role="tab" aria-controls="preferences" aria-selected="false">
                    <i class="fas fa-sliders-h"></i> Preferences
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="green-rentals-tab" data-bs-toggle="tab" data-bs-target="#green-rentals" 
                    type="button" role="tab" aria-controls="green-rentals" aria-selected="false">
                    <i class="fas fa-leaf"></i> Green Rentals
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="tools-tab" data-bs-toggle="tab" data-bs-target="#tools" 
                    type="button" role="tab" aria-controls="tools" aria-selected="false">
                    <i class="fas fa-tools"></i> Tools
                </button>
            </li>
        </ul>
    </div>
    
    {% if all_bookings %}
    <div class="tab-content" id="dashboardTabContent">
        <!-- Bookings Tab -->
        <div class="tab-pane fade show active" id="bookings" role="tabpanel" aria-labelledby="bookings-tab">
            <!-- Dashboard Stats Cards -->
            <div class="dashboard-stats mb-5">
                <div class="stat-card-3d animate-on-scroll rotate-in-left">
                    <div class="stat-card-inner">
                        <div class="stat-card-front">
                            <div class="stat-icon pulse-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <p>Total Bookings</p>
                            <h3 class="counter">{{ all_bookings|length %}</h3>
                        </div>
                        <div class="stat-card-back">
                            <p>Your first booking was on</p>
                            <h4>{{ bookings.last.booking_date|date:"M d, Y" %}</h4>
                            <p class="small">Keep going!</p>
                        </div>
                    </div>
                </div>
                <div class="stat-card-3d animate-on-scroll flip-in-y" style="animation-delay: 0.2s;">
                    <div class="stat-card-inner">
                        <div class="stat-card-front">
                            <div class="stat-icon pulse-icon">
                                <i class="fas fa-car"></i>
                            </div>
                            <p>Active Rentals</p>
                            <h3 class="counter">{{ active_bookings|length %}</h3>
                        </div>
                        <div class="stat-card-back">
                            <p>Your favorite car</p>
                            <h4>{{ bookings.0.car.name %}</h4>
                            <p class="small">Great choice!</p>
                        </div>
                    </div>
                </div>
                <div class="stat-card-3d animate-on-scroll rotate-in-right" style="animation-delay: 0.4s;">
                    <div class="stat-card-inner">
                        <div class="stat-card-front">
                            <div class="stat-icon pulse-icon">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <p>Total Spent</p>
                            <h3>$<span class="counter">{{ total_spent|default:"0" %}</span></h3>
                        </div>
                        <div class="stat-card-back">
                            <p>Loyalty points</p>
                            <h4>{{ all_bookings|length|floatformat:0|add:"450" %}</h4>
                            <p class="small">Redeem for rewards!</p>
                        </div>
                    </div>
                </div>
                <div class="stat-card-3d animate-on-scroll rotate-in-right" style="animation-delay: 0.6s;">
                    <div class="stat-card-inner">
                        <div class="stat-card-front">
                            <div class="stat-icon pulse-icon">
                                <i class="fas fa-leaf"></i>
                            </div>
                            <p>Carbon Offset</p>
                            <h3><span class="counter">{{ all_bookings|length|floatformat:0|add:"120" %}</span> kg</h3>
                        </div>
                        <div class="stat-card-back">
                            <p>Green Status</p>
                            <h4>Silver</h4>
                            <p class="small">Eco-friendly rentals!</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Action Buttons -->
            <div class="quick-actions mb-4 animate-on-scroll fade-in">
                <button type="button" class="btn btn-primary action-button ripple-effect">
                    <i class="fas fa-plus-circle"></i> New Booking
                </button>
                <button type="button" class="btn btn-success action-button ripple-effect">
                    <i class="fas fa-tasks"></i> Compare Cars
                </button>
                <button type="button" class="btn btn-info action-button ripple-effect">
                    <i class="fas fa-map-marked-alt"></i> View Locations
                </button>
                <button type="button" class="btn btn-warning action-button ripple-effect">
                    <i class="fas fa-bell"></i> Set Alerts
                </button>
                <button type="button" class="btn btn-secondary action-button ripple-effect">
                    <i class="fas fa-calendar-alt"></i> View Calendar
                </button>
            </div>
            
            <!-- Booking Status Filter -->
            <div class="booking-filters mb-4 animate-on-scroll slide-in-up">
                <div class="filter-label">
                    <i class="fas fa-filter"></i> Filter by status:
                </div>
                <div class="status-filter">
                    <button type="button" class="filter-btn active" data-filter="all">
                        All ({{ all_bookings|length %})
                    </button>
                    <button type="button" class="filter-btn" data-filter="upcoming">
                        Upcoming ({{ upcoming_bookings|length %})
                    </button>
                    <button type="button" class="filter-btn" data-filter="active">
                        Active ({{ active_bookings|length %})
                    </button>
                    <button type="button" class="filter-btn" data-filter="completed">
                        Completed ({{ past_bookings|length %})
                    </button>
                    <button type="button" class="filter-btn" data-filter="cancelled">
                        Cancelled ({{ cancelled_bookings|length %})
                    </button>
                </div>
            </div>
            
            <!-- Next Booking Feature -->
            {% if next_booking %}
            <div class="next-booking-container animate-on-scroll slide-in-up">
                <h3 class="section-heading floating-element"><i class="fas fa-calendar-day"></i> Your Next Adventure</h3>
                <div class="next-booking-card hover-glow">
                    <div class="particles-background">
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                    </div>
                    <div class="next-booking-countdown">
                        <div class="countdown-circle pulse-slow">
                            <svg class="countdown-svg" viewBox="0 0 100 100">
                                <circle class="countdown-circle-bg" cx="50" cy="50" r="45"></circle>
                                <circle class="countdown-circle-progress" cx="50" cy="50" r="45"></circle>
                            </svg>
                            <div class="countdown-time" data-date="{{ next_booking.start_date|date:'Y/m/d' %}">
                                <span class="days">{{ next_booking.days_until_pickup %}</span>
                                <span class="countdown-label">days</span>
                            </div>
                        </div>
                    </div>
                    <div class="next-booking-details">
                        <h4 class="slide-in-right">{{ next_booking.car.name %} {{ next_booking.car.model %}</h4>
                        <p class="next-booking-date slide-in-right" style="animation-delay: 0.1s;">
                            <i class="fas fa-calendar-alt"></i> {{ next_booking.start_date|date:"l, F j, Y" %} 
                            {% if next_booking.pickup_time %}at {{ next_booking.pickup_time %}{% else %}at 10:00 AM{% endif %}
                        </p>
                        <p class="next-booking-location slide-in-right" style="animation-delay: 0.2s;">
                            <i class="fas fa-map-marker-alt"></i> 
                            {% if next_booking.pickup_location %}
                                {{ next_booking.pickup_location.name %}, {{ next_booking.pickup_location.address %}
                            {% else %}
                                Main Office, 123 Rental Street
                            {% endif %}
                        </p>
                        <div class="next-booking-weather slide-in-right" style="animation-delay: 0.3s;">
                            <i class="fas fa-sun"></i> Expected Weather: Sunny, 75Â°F
                        </div>
                        <div class="next-booking-actions slide-in-right" style="animation-delay: 0.4s;">
                            <a href="#" class="btn btn-sm btn-outline-primary ripple-effect">
                                <i class="fas fa-map-marked-alt"></i> Get Directions
                            </a>
                            <a href="#" class="btn btn-sm btn-primary ripple-effect">
                                <i class="fas fa-edit"></i> Modify
                            </a>
                            <a href="#" class="btn btn-sm btn-success ripple-effect">
                                <i class="fas fa-check-circle"></i> Confirm
                            </a>
                        </div>
                    </div>
                    <div class="next-booking-image">
                        {% if next_booking.car.image %}
                            <img src="{{ next_booking.car.image.url %}" alt="{{ next_booking.car.name %}" class="zoom-on-hover">
                        {% else %}
                            <div class="car-placeholder-large">
                                <i class="fas fa-car-side"></i>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}
            
            <!-- Interactive Booking Timeline -->
            <div class="booking-timeline-container animate-on-scroll scale-in">
                <h3 class="timeline-header floating-element"><i class="fas fa-history"></i> Your Booking Timeline</h3>
                <div class="booking-timeline">
                    {% for booking in all_bookings %}
                        <div class="timeline-item {% if forloop.counter|divisibleby:2 %}timeline-right{% else %}timeline-left{% endif %} animate-on-scroll fade-in booking-status-{{ booking.status %}" style="animation-delay: {{ forloop.counter|add:'-1' %}00ms;" data-status="{{ booking.status %}">
                            <div class="timeline-content">
                                <div class="timeline-date glow-effect">
                                    {{ booking.start_date|date:"M d, Y" %} - {{ booking.end_date|date:"M d, Y" %}
                                </div>
                                <div class="timeline-card hover-float">
                                    <div class="timeline-image">
                                        {% if booking.car.image %}
                                            <img src="{{ booking.car.image.url %}" alt="{{ booking.car.name %}" class="rounded zoom-on-hover">
                                        {% else %}
                                            <div class="car-placeholder">
                                                <i class="fas fa-car"></i>
                                            </div>
                                        {% endif %}
                                        
                                        <div class="booking-status">
                                            {% if booking.status == 'cancelled' %}
                                                <span class="status-badge status-cancelled">
                                                    <i class="fas fa-times-circle"></i> Cancelled
                                                </span>
                                            {% elif booking.is_upcoming %}
                                                <span class="status-badge status-upcoming pulse-animation">
                                                    <i class="fas fa-hourglass-start"></i> Upcoming
                                                </span>
                                            {% elif booking.is_active %}
                                                <span class="status-badge status-active shimmer-effect">
                                                    <i class="fas fa-car-side"></i> Active
                                                </span>
                                            {% else %}
                                                <span class="status-badge status-completed">
                                                    <i class="fas fa-check-circle"></i> Completed
                                                </span>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="timeline-details">
                                        <h4>{{ booking.car.name %} {{ booking.car.model %}</h4>
                                        <p class="text-muted">{{ booking.car.number_plate %}</p>
                                        
                                        <div class="booking-info appear-animation">
                                            <div class="info-item">
                                                <i class="fas fa-calendar"></i>
                                                <span>{{ booking.get_duration_days %} days rental</span>
                                            </div>
                                            <div class="info-item">
                                                <i class="fas fa-dollar-sign"></i>
                                                <span>${{ booking.total_price %} total</span>
                                            </div>
                                            <div class="info-item">
                                                <i class="fas fa-tag"></i>
                                                <span>${{ booking.car.price_per_day %}/day</span>
                                            </div>
                                            
                                            {% if booking.additional_options %}
                                            <div class="info-item">
                                                <i class="fas fa-cog"></i>
                                                <span>{{ booking.additional_options|length %} extras</span>
                                            </div>
                                            {% endif %}
                                        </div>
                                        
                                        <div class="booking-actions">
                                            <button type="button" class="btn btn-sm action-btn view-btn ripple-effect" data-bs-toggle="modal" data-bs-target="#bookingDetailsModal-{{ booking.id %}">
                                                <i class="fas fa-eye"></i> View Details
                                            </button>
                                            
                                            {% if booking.is_upcoming %}
                                                <button type="button" class="btn btn-sm action-btn modify-btn ripple-effect">
                                                    <i class="fas fa-edit"></i> Modify
                                                </button>
                                                <button type="button" class="btn btn-sm action-btn cancel-btn ripple-effect">
                                                    <i class="fas fa-times"></i> Cancel
                                                </button>
                                            {% endif %}
                                            
                                            {% if booking.is_completed %}
                                                <button type="button" class="btn btn-sm action-btn review-btn ripple-effect">
                                                    <i class="fas fa-star"></i> Review
                                                </button>
                                            {% endif %}
                                            
                                            {% if booking.invoice_number %}
                                                <button type="button" class="btn btn-sm action-btn invoice-btn ripple-effect">
                                                    <i class="fas fa-file-invoice"></i> Invoice
                                                </button>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Modal for booking details -->
                        <div class="modal fade" id="bookingDetailsModal-{{ booking.id %}" tabindex="-1" aria-labelledby="bookingDetailsModalLabel-{{ booking.id %}" aria-hidden="true">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="bookingDetailsModalLabel-{{ booking.id %}">
                                            {{ booking.car.name %} {{ booking.car.model %} - Booking Details
                                        </h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="booking-details-modal">
                                            <div class="booking-details-header">
                                                <div class="booking-vehicle">
                                                    {% if booking.car.image %}
                                                        <img src="{{ booking.car.image.url %}" alt="{{ booking.car.name %}" class="booking-vehicle-image">
                                                    {% else %}
                                                        <div class="car-placeholder">
                                                            <i class="fas fa-car"></i>
                                                        </div>
                                                    {% endif %}
                                                    <div class="booking-vehicle-info">
                                                        <h4>{{ booking.car.name %} {{ booking.car.model %}</h4>
                                                        <p>{{ booking.car.number_plate %}</p>
                                                        <div class="booking-status-badge status-{{ booking.status %}">
                                                            {{ booking.get_status_display %}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="booking-reference">
                                                    <div class="reference-item">
                                                        <span class="reference-label">Booking Ref:</span>
                                                        <span class="reference-value">{{ booking.id %}</span>
                                                    </div>
                                                    {% if booking.invoice_number %}
                                                    <div class="reference-item">
                                                        <span class="reference-label">Invoice:</span>
                                                        <span class="reference-value">{{ booking.invoice_number %}</span>
                                                    </div>
                                                    {% endif %}
                                                    <div class="reference-item">
                                                        <span class="reference-label">Booked On:</span>
                                                        <span class="reference-value">{{ booking.booking_date|date:"M d, Y" %}</span>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="booking-details-content">
                                                <div class="detail-section">
                                                    <h5><i class="fas fa-calendar-alt"></i> Rental Period</h5>
                                                    <div class="detail-row">
                                                        <div class="detail-item">
                                                            <span class="detail-label">Pickup:</span>
                                                            <span class="detail-value">{{ booking.start_date|date:"l, F j, Y" %}
                                                                {% if booking.pickup_time %} at {{ booking.pickup_time %}{% endif %}
                                                            </span>
                                                        </div>
                                                        <div class="detail-item">
                                                            <span class="detail-label">Return:</span>
                                                            <span class="detail-value">{{ booking.end_date|date:"l, F j, Y" %}
                                                                {% if booking.return_time %} at {{ booking.return_time %}{% endif %}
                                                            </span>
                                                        </div>
                                                        <div class="detail-item">
                                                            <span class="detail-label">Duration:</span>
                                                            <span class="detail-value">{{ booking.get_duration_days %} days</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="detail-section">
                                                    <h5><i class="fas fa-map-marker-alt"></i> Locations</h5>
                                                    <div class="detail-row">
                                                        <div class="detail-item">
                                                            <span class="detail-label">Pickup Location:</span>
                                                            <span class="detail-value">
                                                                {% if booking.pickup_location %}
                                                                    {{ booking.pickup_location.name %}, {{ booking.pickup_location.address %}
                                                                {% else %}
                                                                    Main Office
                                                                {% endif %}
                                                            </span>
                                                        </div>
                                                        <div class="detail-item">
                                                            <span class="detail-label">Return Location:</span>
                                                            <span class="detail-value">
                                                                {% if booking.return_location %}
                                                                    {{ booking.return_location.name %}, {{ booking.return_location.address %}
                                                                {% else %}
                                                                    Main Office
                                                                {% endif %}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="detail-section">
                                                    <h5><i class="fas fa-dollar-sign"></i> Payment Details</h5>
                                                    <div class="detail-row">
                                                        <div class="detail-item">
                                                            <span class="detail-label">Base Rate:</span>
                                                            <span class="detail-value">${{ booking.car.price_per_day %} per day</span>
                                                        </div>
                                                        <div class="detail-item">
                                                            <span class="detail-label">Payment Method:</span>
                                                            <span class="detail-value">
                                                                {% if booking.payment_method %}
                                                                    {{ booking.get_payment_method_display %}
                                                                {% else %}
                                                                    Credit Card
                                                                {% endif %}
                                                            </span>
                                                        </div>
                                                        <div class="detail-item">
                                                            <span class="detail-label">Payment Status:</span>
                                                            <span class="detail-value">
                                                                {% if booking.payment_status %}
                                                                    <span class="text-success"><i class="fas fa-check-circle"></i> Paid</span>
                                                                {% else %}
                                                                    <span class="text-warning"><i class="fas fa-exclamation-circle"></i> Pending</span>
                                                                {% endif %}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                {% if booking.additional_options %}
                                                <div class="detail-section">
                                                    <h5><i class="fas fa-cog"></i> Additional Options</h5>
                                                    <div class="detail-row extras-list">
                                                        {% for option, cost in booking.additional_options.items %}
                                                            <div class="extra-item">
                                                                <i class="fas fa-check-circle text-success"></i>
                                                                <span class="extra-name">{{ option %}</span>
                                                                <span class="extra-cost">${{ cost %}</span>
                                                            </div>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                                {% endif %}
                                                
                                                <div class="detail-section pricing-summary">
                                                    <h5><i class="fas fa-receipt"></i> Pricing Summary</h5>
                                                    <div class="price-breakdown">
                                                        <div class="price-item">
                                                            <span class="price-label">Daily Rate:</span>
                                                            <span class="price-value">${{ booking.car.price_per_day %}</span>
                                                        </div>
                                                        <div class="price-item">
                                                            <span class="price-label">Number of Days:</span>
                                                            <span class="price-value">{{ booking.get_duration_days %}</span>
                                                        </div>
                                                        <div class="price-item">
                                                            <span class="price-label">Base Rental Cost:</span>
                                                            <span class="price-value">${{ booking.car.price_per_day|floatformat:2|mult:booking.get_duration_days %}</span>
                                                        </div>
                                                        
                                                        {% if booking.additional_options %}
                                                            {% for option, cost in booking.additional_options.items %}
                                                            <div class="price-item">
                                                                <span class="price-label">{{ option %}:</span>
                                                                <span class="price-value">${{ cost|floatformat:2 %}</span>
                                                            </div>
                                                            {% endfor %}
                                                        {% endif %}
                                                        
                                                        <div class="price-item tax-item">
                                                            <span class="price-label">Taxes (8%):</span>
                                                            <span class="price-value">${{ booking.total_price|floatformat:2|mult:0.08|floatformat:2 %}</span>
                                                        </div>
                                                        <div class="price-item total-price">
                                                            <span class="price-label">Total:</span>
                                                            <span class="price-value">${{ booking.total_price|floatformat:2 %}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                {% if booking.customer_notes %}
                                                <div class="detail-section">
                                                    <h5><i class="fas fa-comment"></i> Your Notes</h5>
                                                    <div class="customer-notes">
                                                        {{ booking.customer_notes %}
                                                    </div>
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        {% if booking.is_upcoming %}
                                            <button type="button" class="btn btn-warning">Modify Booking</button>
                                            <button type="button" class="btn btn-danger">Cancel Booking</button>
                                        {% endif %}
                                        
                                        {% if booking.invoice_number %}
                                            <button type="button" class="btn btn-info">
                                                <i class="fas fa-download"></i> Download Invoice
                                            </button>
                                        {% endif %}
                                        
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
            
            <!-- Interactive Rental Statistics -->
            <div class="rental-stats-container animate-on-scroll fade-in">
                <h3 class="section-heading floating-element"><i class="fas fa-chart-line"></i> Your Rental Statistics</h3>
                <div class="stats-cards">
                    <div class="stats-card animate-on-scroll slide-in-left hover-float">
                        <div class="stats-icon rotating-slow">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stats-info">
                            <h5>Most Rented</h5>
                            <p>{{ bookings.0.car.name %}</p>
                        </div>
                    </div>
                    <div class="stats-card animate-on-scroll slide-in-up hover-float" style="animation-delay: 0.2s;">
                        <div class="stats-icon rotating-slow">
                            <i class="fas fa-calendar-week"></i>
                        </div>
                        <div class="stats-info">
                            <h5>Total Days</h5>
                            <p>{{ bookings|length|add:"15" %} days</p>
                        </div>
                    </div>
                    <div class="stats-card animate-on-scroll slide-in-right hover-float" style="animation-delay: 0.4s;">
                        <div class="stats-icon rotating-slow">
                            <i class="fas fa-medal"></i>
                        </div>
                        <div class="stats-info">
                            <h5>Member Status</h5>
                            <p>Gold Member</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Billing Tab -->
        <div class="tab-pane fade" id="billing" role="tabpanel" aria-labelledby="billing-tab">
            <div class="billing-section animate-on-scroll fade-in">
                <div class="section-intro">
                    <h3><i class="fas fa-file-invoice-dollar"></i> Billing & Payments</h3>
                    <p>View your payment history, download invoices, and manage your payment methods.</p>
                </div>
                
                <!-- Payment Methods -->
                <div class="payment-methods mb-4">
                    <h4 class="subsection-title"><i class="fas fa-credit-card"></i> Payment Methods</h4>
                    <div class="payment-cards">
                        <div class="payment-card active">
                            <div class="card-badge">Primary</div>
                            <div class="card-icon"><i class="fab fa-cc-visa"></i></div>
                            <div class="card-details">
                                <h5>Visa ending in 4242</h5>
                                <p>Expires: 05/2026</p>
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-sm btn-outline-primary">Edit</button>
                            </div>
                        </div>
                        
                        <div class="payment-card">
                            <div class="card-icon"><i class="fab fa-cc-mastercard"></i></div>
                            <div class="card-details">
                                <h5>Mastercard ending in 8888</h5>
                                <p>Expires: 11/2025</p>
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-sm btn-outline-primary">Edit</button>
                                <button class="btn btn-sm btn-outline-danger">Remove</button>
                            </div>
                        </div>
                        
                        <div class="add-payment-card">
                            <div class="add-card-icon">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <p>Add Payment Method</p>
                        </div>
                    </div>
                </div>
                
                <!-- Invoices -->
                <div class="invoices-section">
                    <h4 class="subsection-title"><i class="fas fa-receipt"></i> Invoices & Receipts</h4>
                    <div class="invoices-table-wrapper">
                        <table class="invoices-table">
                            <thead>
                                <tr>
                                    <th>Invoice #</th>
                                    <th>Date</th>
                                    <th>Car</th>
                                    <th>Rental Period</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for booking in all_bookings %}
                                    {% if booking.invoice_number %}
                                    <tr>
                                        <td>{{ booking.invoice_number %}</td>
                                        <td>{{ booking.booking_date|date:"M d, Y" %}</td>
                                        <td>{{ booking.car.name %}</td>
                                        <td>{{ booking.start_date|date:"M d" %} - {{ booking.end_date|date:"M d, Y" %}</td>
                                        <td>${{ booking.total_price %}</td>
                                        <td>
                                            {% if booking.payment_status %}
                                                <span class="badge bg-success">Paid</span>
                                            {% else %}
                                                <span class="badge bg-warning">Pending</span>
                                            {% endif %}
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-info"><i class="fas fa-download"></i></button>
                                            <button class="btn btn-sm btn-outline-primary"><i class="fas fa-eye"></i></button>
                                        </td>
                                    </tr>
                                    {% endif %}
                                {% endfor %}
                                
                                <!-- Sample invoices for design purposes -->
                                <tr>
                                    <td>INV-2025-00123</td>
                                    <td>Mar 15, 2025</td>
                                    <td>BMW 5 Series</td>
                                    <td>Mar 17 - Mar 21, 2025</td>
                                    <td>$495.00</td>
                                    <td><span class="badge bg-success">Paid</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-info"><i class="fas fa-download"></i></button>
                                        <button class="btn btn-sm btn-outline-primary"><i class="fas fa-eye"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>INV-2025-00097</td>
                                    <td>Feb 28, 2025</td>
                                    <td>Mercedes C-Class</td>
                                    <td>Mar 01 - Mar 05, 2025</td>
                                    <td>$520.00</td>
                                    <td><span class="badge bg-success">Paid</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-info"><i class="fas fa-download"></i></button>
                                        <button class="btn btn-sm btn-outline-primary"><i class="fas fa-eye"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Billing Summary -->
                <div class="billing-summary animate-on-scroll fade-in">
                    <h4 class="subsection-title"><i class="fas fa-chart-pie"></i> Billing Summary</h4>
                    <div class="billing-stats">
                        <div class="billing-stat-card">
                            <div class="stat-header">
                                <i class="fas fa-wallet"></i>
                                <h5>Total Spent YTD</h5>
                            </div>
                            <div class="stat-value">$1,785.50</div>
                            <div class="stat-footer">+18% from last year</div>
                        </div>
                        
                        <div class="billing-stat-card">
                            <div class="stat-header">
                                <i class="fas fa-car"></i>
                                <h5>Average Per Rental</h5>
                            </div>
                            <div class="stat-value">$387.25</div>
                            <div class="stat-footer">Based on your last 5 rentals</div>
                        </div>
                        
                        <div class="billing-stat-card">
                            <div class="stat-header">
                                <i class="fas fa-tag"></i>
                                <h5>Savings from Discounts</h5>
                            </div>
                            <div class="stat-value">$230.00</div>
                            <div class="stat-footer">Loyalty program benefits</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Preferences Tab -->
        <div class="tab-pane fade" id="preferences" role="tabpanel" aria-labelledby="preferences-tab">
            <div class="preferences-section animate-on-scroll fade-in">
                <div class="section-intro">
                    <h3><i class="fas fa-sliders-h"></i> Your Rental Preferences</h3>
                    <p>Customize your rental experience and save your preferences for faster booking.</p>
                </div>
                
                <div class="preference-categories">
                    <div class="preference-category">
                        <h4><i class="fas fa-car"></i> Vehicle Preferences</h4>
                        <div class="preferences-form">
                            <div class="preference-group">
                                <label>Preferred Vehicle Type</label>
                                <div class="preference-options">
                                    <div class="preference-option">
                                        <input type="radio" id="vehicle-luxury" name="vehicle-type" checked>
                                        <label for="vehicle-luxury">Luxury</label>
                                    </div>
                                    <div class="preference-option">
                                        <input type="radio" id="vehicle-suv" name="vehicle-type">
                                        <label for="vehicle-suv">SUV</label>
                                    </div>
                                    <div class="preference-option">
                                        <input type="radio" id="vehicle-compact" name="vehicle-type">
                                        <label for="vehicle-compact">Compact</label>
                                    </div>
                                    <div class="preference-option">
                                        <input type="radio" id="vehicle-economy" name="vehicle-type">
                                        <label for="vehicle-economy">Economy</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="preference-group">
                                <label>Transmission</label>
                                <div class="preference-options">
                                    <div class="preference-option">
                                        <input type="radio" id="trans-automatic" name="transmission" checked>
                                        <label for="trans-automatic">Automatic</label>
                                    </div>
                                    <div class="preference-option">
                                        <input type="radio" id="trans-manual" name="transmission">
                                        <label for="trans-manual">Manual</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="preference-group">
                                <label>Additional Features</label>
                                <div class="preference-checkboxes">
                                    <div class="preference-checkbox">
                                        <input type="checkbox" id="feature-gps" checked>
                                        <label for="feature-gps">GPS Navigation</label>
                                    </div>
                                    <div class="preference-checkbox">
                                        <input type="checkbox" id="feature-bluetooth" checked>
                                        <label for="feature-bluetooth">Bluetooth</label>
                                    </div>
                                    <div class="preference-checkbox">
                                        <input type="checkbox" id="feature-child-seat">
                                        <label for="feature-child-seat">Child Seat</label>
                                    </div>
                                    <div class="preference-checkbox">
                                        <input type="checkbox" id="feature-wifi">
                                        <label for="feature-wifi">WiFi Hotspot</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="preference-category">
                        <h4><i class="fas fa-map-marker-alt"></i> Location Preferences</h4>
                        <div class="preferences-form">
                            <div class="preference-group">
                                <label>Preferred Pickup Location</label>
                                <select class="form-select">
                                    <option>Downtown Office</option>
                                    <option>Airport Terminal</option>
                                    <option>North Branch</option>
                                    <option>South Branch</option>
                                </select>
                            </div>
                            
                            <div class="preference-group">
                                <label>Default Same Return Location</label>
                                <div class="preference-toggle">
                                    <input type="checkbox" id="same-location" class="toggle-checkbox" checked>
                                    <label for="same-location" class="toggle-label"></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="preference-category">
                        <h4><i class="fas fa-bell"></i> Notification Preferences</h4>
                        <div class="preferences-form">
                            <div class="preference-group">
                                <label>Email Notifications</label>
                                <div class="preference-checkboxes">
                                    <div class="preference-checkbox">
                                        <input type="checkbox" id="email-booking" checked>
                                        <label for="email-booking">Booking Confirmations</label>
                                    </div>
                                    <div class="preference-checkbox">
                                        <input type="checkbox" id="email-reminder" checked>
                                        <label for="email-reminder">Pickup Reminders</label>
                                    </div>
                                    <div class="preference-checkbox">
                                        <input type="checkbox" id="email-special">
                                        <label for="email-special">Special Offers</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="preference-group">
                                <label>SMS Notifications</label>
                                <div class="preference-toggle">
                                    <input type="checkbox" id="sms-notifications" class="toggle-checkbox">
                                    <label for="sms-notifications" class="toggle-label"></label>
                                </div>
                                <div class="preference-hint">Receive text reminders for upcoming rentals</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="preferences-actions">
                    <button class="btn btn-primary">Save Preferences</button>
                    <button class="btn btn-outline-secondary">Reset to Default</button>
                </div>
            </div>
        </div>
        
        <!-- Green Rentals Tab -->
        <div class="tab-pane fade" id="green-rentals" role="tabpanel" aria-labelledby="green-rentals-tab">
            <div class="green-rentals-section animate-on-scroll fade-in">
                <div class="section-intro">
                    <h3><i class="fas fa-leaf"></i> Green Rental Program</h3>
                    <p>Make environmentally conscious choices with our eco-friendly vehicle options.</p>
                </div>
                
                <div class="eco-stats mb-4">
                    <div class="eco-stat-card">
                        <div class="eco-icon">
                            <i class="fas fa-tree"></i>
                        </div>
                        <div class="eco-stat-value">{{ all_bookings|length|floatformat:0|add:"120" %}</div>
                        <div class="eco-stat-label">kg COâ Offset</div>
                    </div>
                    
                    <div class="eco-stat-card">
                        <div class="eco-icon">
                            <i class="fas fa-gas-pump"></i>
                        </div>
                        <div class="eco-stat-value">{{ all_bookings|length|floatformat:0|add:"65" %}</div>
                        <div class="eco-stat-label">Gallons Saved</div>
                    </div>
                    
                    <div class="eco-stat-card">
                        <div class="eco-icon">
                            <i class="fas fa-seedling"></i>
                        </div>
                        <div class="eco-stat-value">{{ all_bookings|length|floatformat:0|add:"5" %}</div>
                        <div class="eco-stat-label">Trees Planted</div>
                    </div>
                    
                    <div class="eco-stat-card">
                        <div class="eco-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="eco-stat-value">Silver</div>
                        <div class="eco-stat-label">Green Status</div>
                    </div>
                </div>
                
                <div class="green-vehicle-options">
                    <h4 class="subsection-title">Available Eco-Friendly Vehicles</h4>
                    <div class="green-vehicles">
                        <div class="green-vehicle-card">
                            <div class="eco-badge">
                                <i class="fas fa-leaf"></i>
                                <span>Eco-Friendly</span>
                            </div>
                            <div class="vehicle-image">
                                <img src="{% static 'img/cars/luxury1.svg' %}" alt="Tesla Model 3">
                            </div>
                            <div class="vehicle-info">
                                <h5>Tesla Model 3</h5>
                                <div class="vehicle-specs">
                                    <div class="spec-item">
                                        <i class="fas fa-bolt"></i>
                                        <span>310 mi range</span>
                                    </div>
                                    <div class="spec-item">
                                        <i class="fas fa-leaf"></i>
                                        <span>100% Electric</span>
                                    </div>
                                    <div class="spec-item">
                                        <i class="fas fa-tachometer-alt"></i>
                                        <span>0-60 mph: 5.3s</span>
                                    </div>
                                </div>
                                <div class="vehicle-price">
                                    <span class="price-value">$110</span> /day
                                </div>
                                <button class="btn btn-primary btn-sm"><i class="fas fa-info-circle"></i> Learn More</button>
                            </div>
                        </div>
                        
                        <div class="green-vehicle-card">
                            <div class="eco-badge">
                                <i class="fas fa-leaf"></i>
                                <span>Eco-Friendly</span>
                            </div>
                            <div class="vehicle-image">
                                <img src="{% static 'img/cars/luxury2.svg' %}" alt="BMW i4">
                            </div>
                            <div class="vehicle-info">
                                <h5>BMW i4</h5>
                                <div class="vehicle-specs">
                                    <div class="spec-item">
                                        <i class="fas fa-bolt"></i>
                                        <span>300 mi range</span>
                                    </div>
                                    <div class="spec-item">
                                        <i class="fas fa-leaf"></i>
                                        <span>100% Electric</span>
                                    </div>
                                    <div class="spec-item">
                                        <i class="fas fa-tachometer-alt"></i>
                                        <span>0-60 mph: 5.7s</span>
                                    </div>
                                </div>
                                <div class="vehicle-price">
                                    <span class="price-value">$125</span> /day
                                </div>
                                <button class="btn btn-primary btn-sm"><i class="fas fa-info-circle"></i> Learn More</button>
                            </div>
                        </div>
                        
                        <div class="green-vehicle-card">
                            <div class="eco-badge">
                                <i class="fas fa-leaf"></i>
                                <span>Eco-Friendly</span>
                            </div>
                            <div class="vehicle-image">
                                <img src="{% static 'img/cars/luxury3.svg' %}" alt="Toyota Prius">
                            </div>
                            <div class="vehicle-info">
                                <h5>Toyota Prius</h5>
                                <div class="vehicle-specs">
                                    <div class="spec-item">
                                        <i class="fas fa-gas-pump"></i>
                                        <span>55 mpg</span>
                                    </div>
                                    <div class="spec-item">
                                        <i class="fas fa-leaf"></i>
                                        <span>Hybrid</span>
                                    </div>
                                    <div class="spec-item">
                                        <i class="fas fa-tachometer-alt"></i>
                                        <span>0-60 mph: 9.8s</span>
                                    </div>
                                </div>
                                <div class="vehicle-price">
                                    <span class="price-value">$85</span> /day
                                </div>
                                <button class="btn btn-primary btn-sm"><i class="fas fa-info-circle"></i> Learn More</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="carbon-offset-program mt-4">
                    <h4 class="subsection-title">Carbon Offset Program</h4>
                    <div class="offset-info">
                        <p>Join our carbon offset program to neutralize your rental's environmental impact. For just $5 per rental, we'll plant trees and invest in renewable energy projects.</p>
                        
                        <div class="carbon-progress">
                            <div class="progress-label">Progress to Gold Green Status</div>
                            <div class="progress">
                                <div class="progress-bar bg-success" role="progressbar" style="width: 65%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <div class="progress-info">65% Complete</div>
                        </div>
                        
                        <button class="btn btn-success mt-3">
                            <i class="fas fa-leaf"></i> Enroll in Carbon Offset Program
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tools Tab -->
        <div class="tab-pane fade" id="tools" role="tabpanel" aria-labelledby="tools-tab">
            <div class="tools-section animate-on-scroll fade-in">
                <div class="section-intro">
                    <h3><i class="fas fa-tools"></i> Rental Tools & Resources</h3>
                    <p>Useful tools to enhance your car rental experience.</p>
                </div>
                
                <div class="tools-grid">
                    <div class="tool-card">
                        <div class="tool-icon">
                            <i class="fas fa-car-side"></i>
                        </div>
                        <h4>Car Comparison Tool</h4>
                        <p>Compare up to 3 vehicles side by side to find the perfect match for your needs.</p>
                        <button class="btn btn-primary btn-sm">Launch Tool</button>
                    </div>
                    
                    <div class="tool-card">
                        <div class="tool-icon">
                            <i class="fas fa-map-marked-alt"></i>
                        </div>
                        <h4>Location Finder</h4>
                        <p>Find pickup and drop-off locations with real-time availability.</p>
                        <button class="btn btn-primary btn-sm">Launch Tool</button>
                    </div>
                    
                    <div class="tool-card">
                        <div class="tool-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <h4>Availability Calendar</h4>
                        <p>View car availability for your preferred dates and plan accordingly.</p>
                        <button class="btn btn-primary btn-sm">Launch Tool</button>
                    </div>
                    
                    <div class="tool-card">
                        <div class="tool-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <h4>Price Calculator</h4>
                        <p>Calculate the total cost of your rental including optional extras.</p>
                        <button class="btn btn-primary btn-sm">Launch Tool</button>
                    </div>
                    
                    <div class="tool-card">
                        <div class="tool-icon">
                            <i class="fas fa-search-location"></i>
                        </div>
                        <h4>Car Recommendation</h4>
                        <p>Get personalized vehicle recommendations based on your location and needs.</p>
                        <button class="btn btn-primary btn-sm">Launch Tool</button>
                    </div>
                    
                    <div class="tool-card">
                        <div class="tool-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <h4>Email Notifications</h4>
                        <p>Set up custom email alerts for booking reminders and special offers.</p>
                        <button class="btn btn-primary btn-sm">Configure</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% else %}
        <div class="empty-state-container animate-on-scroll scale-in">
            <div class="empty-state-card hover-float">
                <div class="pulsating-circle">
                    <div class="empty-state-icon">
                        <i class="fas fa-calendar-times"></i>
                    </div>
                </div>
                <h3 class="text-reveal">Your Booking Journey Awaits</h3>
                <p class="typing-animation">You haven't made any car bookings yet. Explore our collection of premium vehicles and start your adventure today.</p>
                <a href="{% url 'car_list' %}" class="btn btn-lg btn-primary gradient-btn">
                    <i class="fas fa-car-side me-2"></i>Browse Available Cars
                </a>
            </div>
            <div class="floating-cars">
                <div class="floating-car floating-car-1"><i class="fas fa-car-side"></i></div>
                <div class="floating-car floating-car-2"><i class="fas fa-car-side"></i></div>
                <div class="floating-car floating-car-3"><i class="fas fa-car-side"></i></div>
            </div>
        </div>
        
        <!-- Enhanced Recommended Cars Section -->
        <div class="featured-recommendations animate-on-scroll fade-in">
            <h3 class="section-heading text-center floating-element"><i class="fas fa-star"></i> Recommended For You</h3>
            <div class="recommended-cars">
                {% for car in recommended_cars %}
                    <div class="recommended-car-card animate-on-scroll slide-in-up hover-float" style="animation-delay: {{ forloop.counter|add:"-1" %}00ms">
                        <div class="car-card-image">
                            {% if car.image %}
                                <img src="{{ car.image.url %}" alt="{{ car.name %} {{ car.model %}" class="zoom-on-hover">
                            {% else %}
                                <div class="car-placeholder-large">
                                    <i class="fas fa-car"></i>
                                </div>
                            {% endif %}
                            <div class="car-price-badge pulse-animation">${{ car.price_per_day %}<span>/day</span></div>
                            <div class="car-rating-badge">
                                <i class="fas fa-star"></i> 4.9
                            </div>
                        </div>
                        <div class="car-card-body">
                            <h4 class="car-title">{{ car.name %} {{ car.model %}</h4>
                            <div class="car-features">
                                <span class="car-feature ripple-effect"><i class="fas fa-car"></i> Luxury</span>
                                <span class="car-feature ripple-effect"><i class="fas fa-gas-pump"></i> Hybrid</span>
                                <span class="car-feature ripple-effect"><i class="fas fa-star"></i> 4.9</span>
                            </div>
                            <p>Experience luxury and comfort with the {{ car.name %} {{ car.model %}.</p>
                            <div class="animated-divider"></div>
                            <a href="{% url 'book_car' car.id %}" class="btn btn-primary btn-block ripple-effect">
                                <i class="fas fa-calendar-check me-2"></i>Book Now
                            </a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
</div>

<!-- CSS for Dashboard styling -->
<style>
/* Dashboard Styling */
.dashboard-tabs {
    margin-bottom: 30px;
}

.nav-tabs .nav-link {
    color: #495057;
    border: none;
    padding: 12px 20px;
    border-radius: 0;
    font-weight: 500;
    transition: all 0.3s ease;
}

.nav-tabs .nav-link i {
    margin-right: 8px;
}

.nav-tabs .nav-link.active {
    color: var(--primary-color);
    border-bottom: 3px solid var(--primary-color);
    background-color: rgba(58, 125, 68, 0.05);
}

.quick-actions {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 30px;
}

.action-button {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    border-radius: 8px;
    transition: all 0.3s ease;
    font-weight: 500;
}

.action-button i {
    margin-right: 8px;
}

.booking-filters {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 15px;
    background-color: #f8f9fa;
    padding: 15px;
    border-radius: 10px;
}

.filter-label {
    font-weight: 500;
    display: flex;
    align-items: center;
}

.filter-label i {
    margin-right: 8px;
    color: var(--primary-color);
}

.status-filter {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.filter-btn {
    background-color: white;
    border: 1px solid #ddd;
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.filter-btn.active {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

/* Billing Tab Styling */
.billing-section {
    padding: 20px 0;
}

.section-intro {
    margin-bottom: 30px;
}

.section-intro h3 {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
}

.section-intro h3 i {
    margin-right: 10px;
    color: var(--primary-color);
}

.subsection-title {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
    font-size: 1.25rem;
}

.subsection-title i {
    margin-right: 10px;
    color: var(--primary-color);
}

.payment-methods {
    margin-bottom: 40px;
}

.payment-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.payment-card {
    background-color: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    display: flex;
    align-items: center;
    position: relative;
}

.payment-card.active {
    border: 2px solid var(--primary-color);
}

.card-badge {
    position: absolute;
    top: -10px;
    right: 10px;
    background-color: var(--primary-color);
    color: white;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
}

.card-icon {
    font-size: 2rem;
    margin-right: 15px;
    color: #495057;
}

.card-icon .fa-cc-visa {
    color: #0157a2;
}

.card-icon .fa-cc-mastercard {
    color: #eb001b;
}

.card-details {
    flex: 1;
}

.card-details h5 {
    margin-bottom: 5px;
}

.card-details p {
    margin-bottom: 0;
    color: #6c757d;
    font-size: 0.9rem;
}

.card-actions {
    display: flex;
    gap: 10px;
}

.add-payment-card {
    background-color: #f8f9fa;
    border: 2px dashed #dee2e6;
    border-radius: 10px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.add-payment-card:hover {
    background-color: #e9ecef;
}

.add-card-icon {
    font-size: 2rem;
    color: #6c757d;
    margin-bottom: 10px;
}

.add-payment-card p {
    margin-bottom: 0;
    font-weight: 500;
}

.invoices-table-wrapper {
    overflow-x: auto;
    margin-bottom: 30px;
}

.invoices-table {
    width: 100%;
    border-collapse: collapse;
}

.invoices-table th,
.invoices-table td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid #dee2e6;
}

.invoices-table th {
    background-color: #f8f9fa;
    font-weight: 600;
}

.invoices-table tr:hover {
    background-color: #f8f9fa;
}

.billing-stats {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.billing-stat-card {
    background-color: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    text-align: center;
}

.stat-header {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
}

.stat-header i {
    font-size: 1.5rem;
    color: var(--primary-color);
    margin-right: 10px;
}

.stat-header h5 {
    margin-bottom: 0;
}

.stat-value {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 10px;
    color: var(--primary-color);
}

.stat-footer {
    font-size: 0.85rem;
    color: #6c757d;
}

/* Preferences Tab Styling */
.preferences-section {
    padding: 20px 0;
}

.preference-categories {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 30px;
    margin-bottom: 30px;
}

.preference-category {
    background-color: white;
    border-radius: 10px;
    padding: 25px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
}

.preference-category h4 {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
    font-size: 1.25rem;
}

.preference-category h4 i {
    margin-right: 10px;
    color: var(--primary-color);
}

.preferences-form {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.preference-group {
    margin-bottom: 15px;
}

.preference-group label {
    display: block;
    margin-bottom: 10px;
    font-weight: 500;
}

.preference-options {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
}

.preference-option {
    position: relative;
}

.preference-option input[type="radio"] {
    position: absolute;
    opacity: 0;
}

.preference-option label {
    display: block;
    padding: 10px 20px;
    background-color: #f8f9fa;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 0;
    font-weight: normal;
}

.preference-option input[type="radio"]:checked + label {
    background-color: var(--primary-color);
    color: white;
}

.preference-checkboxes {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 10px;
}

.preference-checkbox {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
}

.preference-checkbox input[type="checkbox"] {
    margin-right: 10px;
}

.preference-toggle {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 30px;
}

.toggle-checkbox {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-label {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 30px;
}

.toggle-label:before {
    position: absolute;
    content: "";
    height: 22px;
    width: 22px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

.toggle-checkbox:checked + .toggle-label {
    background-color: var(--primary-color);
}

.toggle-checkbox:checked + .toggle-label:before {
    transform: translateX(30px);
}

.preference-hint {
    font-size: 0.85rem;
    color: #6c757d;
    margin-top: 5px;
}

.preferences-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
}

/* Green Rentals Tab Styling */
.green-rentals-section {
    padding: 20px 0;
}

.eco-stats {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.eco-stat-card {
    background-color: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    text-align: center;
}

.eco-icon {
    font-size: 2rem;
    color: #4CAF50;
    margin-bottom: 15px;
}

.eco-stat-value {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 10px;
}

.eco-stat-label {
    font-size: 0.9rem;
    color: #6c757d;
}

.green-vehicles {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.green-vehicle-card {
    background-color: white;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    position: relative;
}

.eco-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background-color: #4CAF50;
    color: white;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    z-index: 1;
}

.eco-badge i {
    margin-right: 5px;
}

.vehicle-image {
    height: 180px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f8f9fa;
    padding: 20px;
}

.vehicle-image img {
    max-height: 120px;
    max-width: 100%;
}

.vehicle-info {
    padding: 20px;
}

.vehicle-info h5 {
    margin-bottom: 15px;
}

.vehicle-specs {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-bottom: 15px;
}

.spec-item {
    font-size: 0.9rem;
    color: #6c757d;
    display: flex;
    align-items: center;
}

.spec-item i {
    margin-right: 5px;
    color: #4CAF50;
}

.vehicle-price {
    margin-bottom: 15px;
    font-size: 0.95rem;
    color: #6c757d;
}

.price-value {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--primary-color);
}

.carbon-offset-program {
    background-color: #f8f9fa;
    border-radius: 10px;
    padding: 25px;
}

.offset-info {
    max-width: 800px;
    margin: 0 auto;
}

.carbon-progress {
    margin-top: 20px;
    margin-bottom: 20px;
}

.progress-label {
    margin-bottom: 10px;
    font-weight: 500;
}

.progress-info {
    text-align: right;
    margin-top: 5px;
    font-size: 0.9rem;
    color: #6c757d;
}

/* Tools Tab Styling */
.tools-section {
    padding: 20px 0;
}

.tools-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 30px;
}

.tool-card {
    background-color: white;
    border-radius: 10px;
    padding: 25px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    text-align: center;
    transition: all 0.3s ease;
}

.tool-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
}

.tool-icon {
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 20px;
}

.tool-card h4 {
    margin-bottom: 15px;
}

.tool-card p {
    margin-bottom: 20px;
    color: #6c757d;
}

/* Booking Detail Modal Styling */
.booking-details-modal {
    padding: 20px 0;
}

.booking-details-header {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 1px solid #dee2e6;
}

.booking-vehicle {
    flex: 1;
    min-width: 250px;
    display: flex;
    align-items: center;
    gap: 20px;
}

.booking-vehicle-image {
    width: 100px;
    height: 70px;
    object-fit: contain;
}

.booking-vehicle-info h4 {
    margin-bottom: 5px;
}

.booking-vehicle-info p {
    margin-bottom: 10px;
    color: #6c757d;
}

.booking-status-badge {
    display: inline-block;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
}

.booking-status-badge.status-pending {
    background-color: #ffeeba;
    color: #856404;
}

.booking-status-badge.status-confirmed {
    background-color: #d4edda;
    color: #155724;
}

.booking-status-badge.status-active {
    background-color: #cce5ff;
    color: #004085;
}

.booking-status-badge.status-completed {
    background-color: #d4edda;
    color: #155724;
}

.booking-status-badge.status-cancelled {
    background-color: #f8d7da;
    color: #721c24;
}

.booking-reference {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.reference-item {
    display: flex;
    align-items: center;
    gap: 10px;
}

.reference-label {
    font-weight: 500;
    color: #6c757d;
}

.reference-value {
    font-weight: 600;
}

.booking-details-content {
    display: flex;
    flex-direction: column;
    gap: 25px;
}

.detail-section {
    margin-bottom: 20px;
}

.detail-section h5 {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #f0f0f0;
}

.detail-section h5 i {
    margin-right: 10px;
    color: var(--primary-color);
}

.detail-row {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
}

.detail-item {
    min-width: 200px;
    flex: 1;
}

.detail-label {
    display: block;
    font-weight: 500;
    margin-bottom: 5px;
    color: #6c757d;
}

.detail-value {
    font-weight: 400;
}

.extras-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 10px;
}

.extra-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    background-color: #f8f9fa;
    border-radius: 5px;
}

.extra-name {
    flex: 1;
}

.extra-cost {
    font-weight: 500;
}

.pricing-summary {
    background-color: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
}

.price-breakdown {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.price-item {
    display: flex;
    justify-content: space-between;
    padding: 5px 0;
    border-bottom: 1px dashed #dee2e6;
}

.price-item:last-child {
    border-bottom: none;
}

.tax-item {
    padding-top: 10px;
    border-top: 1px solid #dee2e6;
    font-style: italic;
}

.total-price {
    font-weight: 700;
    font-size: 1.1rem;
    margin-top: 10px;
    border-top: 2px solid #dee2e6;
    padding-top: 10px;
}

.customer-notes {
    background-color: #f8f9fa;
    padding: 15px;
    border-left: 4px solid var(--primary-color);
    border-radius: 4px;
    font-style: italic;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .booking-vehicle {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .detail-row {
        flex-direction: column;
    }
    
    .booking-details-header {
        flex-direction: column;
    }
    
    .payment-cards {
        grid-template-columns: 1fr;
    }
    
    .preference-categories {
        grid-template-columns: 1fr;
    }
    
    .green-vehicles {
        grid-template-columns: 1fr;
    }
    
    .tools-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Text reveal animation
        const textRevealElements = document.querySelectorAll('.text-reveal');
        textRevealElements.forEach(element => {
            const text = element.textContent;
            element.textContent = '';
            
            for (let i = 0; i < text.length; i++) {
                const span = document.createElement('span');
                span.textContent = text[i];
                span.classList.add('reveal-letter');
                element.appendChild(span);
            }
        });
        
        // Typing animation
        const typingElements = document.querySelectorAll('.typing-animation');
        typingElements.forEach(element => {
            const text = element.textContent;
            element.innerHTML = '<span class="typing-cursor">|</span>';
            let index = 0;
            
            const typeText = () => {
                if (index < text.length) {
                    element.insertBefore(document.createTextNode(text[index]), element.querySelector('.typing-cursor'));
                    index++;
                    setTimeout(typeText, 50 + Math.random() * 50);
                }
            };
            
            // Start typing when element is in view
            const typingObserver = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        setTimeout(typeText, 500);
                        typingObserver.unobserve(element);
                    }
                });
            });
            
            typingObserver.observe(element);
        });
        
        // Ripple effect for buttons
        const rippleButtons = document.querySelectorAll('.ripple-effect');
        rippleButtons.forEach(button => {
            button.addEventListener('click', function(e) {
                const x = e.clientX - e.target.getBoundingClientRect().left;
                const y = e.clientY - e.target.getBoundingClientRect().top;
                
                const ripple = document.createElement('span');
                ripple.classList.add('ripple');
                ripple.style.left = `${x}px`;
                ripple.style.top = `${y}px`;
                
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        });
        
        // Animate elements on scroll with smoother transitions
        const animateElements = document.querySelectorAll('.animate-on-scroll');
        
        const isInViewport = (element) => {
            const rect = element.getBoundingClientRect();
            return (
                rect.top <= (window.innerHeight || document.documentElement.clientHeight) * 0.8 &&
                rect.bottom >= 0
            );
        };
        
        const handleScrollAnimation = () => {
            animateElements.forEach(element => {
                if (isInViewport(element) && !element.classList.contains('animated')) {
                    element.classList.add('animated');
                }
            });
        };
        
        // Run once on load
        handleScrollAnimation();
        
        // Add event listener with throttling for better performance
        let scrollTimeout;
        window.addEventListener('scroll', () => {
            if (!scrollTimeout) {
                scrollTimeout = setTimeout(() => {
                    handleScrollAnimation();
                    scrollTimeout = null;
                }, 50);
            }
        });
        
        // 3D card rotation effect
        const cards3d = document.querySelectorAll('.stat-card-3d');
        cards3d.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.querySelector('.stat-card-inner').style.transform = 'rotateY(180deg)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.querySelector('.stat-card-inner').style.transform = 'rotateY(0deg)';
            });
        });
        
        // Filter booking by status
        const filterButtons = document.querySelectorAll('.filter-btn');
        const timelineItems = document.querySelectorAll('.timeline-item');
        
        filterButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                filterButtons.forEach(btn => btn.classList.remove('active'));
                
                // Add active class to clicked button
                button.classList.add('active');
                
                // Get filter value
                const filterValue = button.getAttribute('data-filter');
                
                // Show all items if filter is 'all'
                if (filterValue === 'all') {
                    timelineItems.forEach(item => {
                        item.style.display = 'block';
                    });
                    return;
                }
                
                // Filter items based on status
                timelineItems.forEach(item => {
                    if (item.classList.contains(`booking-status-${filterValue}`)) {
                        item.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        });
    });
</script>
{% endblock %}
